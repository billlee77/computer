<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head>


<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="index,nofollow">

<title>CustomXSession - Ubuntu Wiki</title>
<script type="text/javascript" src="CustomXSession_files/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="CustomXSession_files/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="CustomXSession_files/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="CustomXSession_files/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="CustomXSession_files/projection.css">

<!-- css only for MSIE browsers -->
<!--[if IE]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/htdocs/ubuntu/css/msie.css">
<![endif]-->



<link rel="Start" href="https://wiki.ubuntu.com/Home">
<link rel="Alternate" title="Wiki Markup" href="https://wiki.ubuntu.com/CustomXSession?action=raw">
<link rel="Alternate" media="print" title="Print View" href="https://wiki.ubuntu.com/CustomXSession?action=print">
<link rel="Search" href="https://wiki.ubuntu.com/FindPage">
<link rel="Index" href="https://wiki.ubuntu.com/TitleIndex">
<link rel="Glossary" href="https://wiki.ubuntu.com/WordIndex">
<link rel="Help" href="https://wiki.ubuntu.com/HelpOnFormatting">
</head><body dir="ltr" lang="en">

<div id="header">
<div id="mastwrap"><div id="masthead">
<div id="logo"><a href="https://wiki.ubuntu.com/Home">Ubuntu Wiki</a></div>

<form id="searchform" method="get" action="/CustomXSession">
<div>
<input name="action" value="fullsearch" type="hidden">
<input name="context" value="180" type="hidden">
<label style="display: none;" for="searchinput">Search:</label>
<input class="disabled" id="searchinput" name="value" value="Search" size="20" onfocus="searchFocus(this)" onblur="searchBlur(this)" onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search" type="text">
<input disabled="disabled" id="titlesearch" name="titlesearch" value="Titles" alt="Search Titles" type="submit">
<input disabled="disabled" id="fullsearch" name="fullsearch" value="Text" alt="Search Full Text" type="submit">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<ul id="username"><li><a href="https://wiki.ubuntu.com/CustomXSession?action=login" id="login" rel="nofollow">Log In / Register</a></li></ul>

  <div id="sisternav">
      <ul>
        <li id="plain">
            <a href="http://www.ubuntu.com/" accesskey="t">Ubuntu</a>
        </li>
        <li id="plain">
            <a href="http://www.ubuntu.com/community" accesskey="t">Community</a>
        </li>
        <li id="plain">
            <a href="http://www.ubuntu.com/support" accesskey="t">Support</a>
        </li>
        <li id="plain">
            <a href="http://www.ubuntu.com/partners/program" accesskey="t">Partners</a>
        </li>
        <li id="current">
            <a href="http://wiki.ubuntu.com/" accesskey="t">Wiki</a>
        </li>
        <li id="plain">
            <a href="http://planet.ubuntulinux.org/" accesskey="t">Planet</a>
        </li>
      </ul>
  </div>

</div></div>


<ul id="navibar">

</ul>


<ul id="pagetrail">
<li><a href="https://wiki.ubuntu.com/CustomXSession">CustomXSession</a></li>
</ul>
<ul class="extranav">
<li><a href="https://wiki.ubuntu.com/UserPreferences">User Preferences</a></li>
<li><a href="https://wiki.ubuntu.com/FindPage">Find Page</a></li>
</ul>
<ul class="editbar"><li><span class="disabled">Immutable Page</span></li><li><a href="#" class="toggleCommentsButton" style="display: none;" onclick="toggleComments();return false;">Comments</a></li><li><a class="nbinfo" href="https://wiki.ubuntu.com/CustomXSession?action=info" rel="nofollow">Info</a></li><li><a class="nbattachments" href="https://wiki.ubuntu.com/CustomXSession?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="get" action="/CustomXSession">
<div>
    
    <select name="action" onchange="if ((this.selectedIndex != 0) &amp;&amp;
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option selected="selected" value="show">More Actions:</option><option value="raw">Raw Text</option>
<option value="print">Print View</option>
<option value="RenderAsDocbook">Render as Docbook</option>
<option value="refresh">Delete Cache</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="SpellCheck">Check Spelling</option>
<option value="LikePages">Like Pages</option>
<option value="LocalSiteMap">Local Site Map</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="RenamePage" disabled="disabled" class="disabled">Rename Page</option>
<option value="CopyPage">Copy Page</option>
<option value="DeletePage" disabled="disabled" class="disabled">Delete Page</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="MyPages">My Pages</option>
<option value="SubscribeUser">Subscribe User</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="Despam">Remove Spam</option>
<option value="revert">Revert to this revision</option>
<option value="PackagePages">Package Pages</option>
<option value="SyncPages">Sync Pages</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="Load">Load</option>
<option value="Save">Save</option>
    </select>
    
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

</div>

<div id="page" dir="ltr" lang="en">


<ul id="pagelocation">
<li>CustomXSession</li>
</ul>
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><p class="line862">This page 
will teach you how to design your own personalized X (graphical desktop)
 sessions by editing shell scripts. Desktop environments like <a class="http" href="http://www.gnome.org/">GNOME</a>
 often have their own session managers. These session managers allow you
 to specify which additional programs will be loaded at the beginning of
 your session by providing a graphical interface. However, knowing how 
to create X session scripts can grant you greater flexibility in 
customizing your desktop environment whether you use GNOME, <a class="http" href="http://www.kde.org/">KDE</a>, <a class="http" href="http://www.xfce.org/">XFCE</a>, <a href="https://wiki.ubuntu.com/Openbox">Openbox</a> or other lesser-known window managers like <a class="http" href="http://blackboxwm.sourceforge.net/">Blackbox</a> or <a href="https://wiki.ubuntu.com/FVWM">FVWM</a>.
 Furthermore, being able to create X session scripts allows you to run a
 graphical desktop even if the graphical login manager, GDM, is broken 
or not installed. <span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span></p><p class="line867"></p><div class="table-of-contents"><p class="table-of-contents-heading">Contents</p><ol><li><a href="#Anatomy%20of%20a%20simple%20X%20session%20script">Anatomy of a simple X session script</a></li><li><a href="#How%20to%20create%20a%20X%20session%20script">How to create a X session script</a></li><li><a href="#Sample%20%7E/.xinitrc%20File">Sample ~/.xinitrc File</a></li><li><a href="#Questions%20and%20Comments">Questions and Comments</a></li></ol></div> <span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><p class="line867">
</p><h2 id="Anatomy of a simple X session script">Anatomy of a simple X session script</h2>
<span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><p class="line874">The simplest possible X session script consists of two commands, as shown in the example below: <span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span></p><pre> #!/usr/bin/env bash
 exec gnome-session</pre><span class="anchor" id="line-12"></span><p class="line874">The
 first line is common to all Linux shell scripts; it specifies the shell
 used to process the script. In the case of the example shown above, the
 bash (Bourne Again Shell) has been specified as the shell. <span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span></p><p class="line874">The
 second line specifies the application that drives the X session. This 
is sometimes called the "magic process", as the X session will end when 
this application stops running. The "magic process" in the case of the 
above example is "gnome-session", which will launch the GNOME desktop 
environment. <span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span></p><p class="line867">
</p><h2 id="How to create a X session script">How to create a X session script</h2>
<span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><p class="line874">You do not have to have root privileges to create your own X session script. <span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span></p><ol start="1" type="1"><li><p class="line862">Open a terminal by opening the <strong>Applications</strong> menu, select <strong>Accessories</strong>, and then click <strong>Terminal</strong>.  <span class="anchor" id="line-21"></span></p></li><li>To begin editing your script, type the following command at the prompt: <span class="anchor" id="line-22"></span></li></ol><p class="line867"><span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span></p><pre>gedit ~/.xinitrc</pre><span class="anchor" id="line-25"></span><p class="line862">You should now have an empty text editor window on your screen. Any changes you make will be saved to the file <strong>.xinitrc</strong>, which will be hidden in your home directory. (<strong>Note:</strong> In Linux, all files that begin with a period are treated by the system as hidden files.) <span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span></p><ol start="3" type="1"><li>Specify the shell on the first line: <span class="anchor" id="line-28"></span></li></ol><p class="line867"><span class="anchor" id="line-29"></span><span class="anchor" id="line-30"></span></p><pre> #!/usr/bin/env bash</pre><span class="anchor" id="line-31"></span><ol start="4" type="1"><li><p class="line862">Type
 in any commands you want to run before launching your desktop 
environment or window manager. Use one command per line, and place a <strong>&amp;</strong> after each command. Placing an ampersand (&amp;) after each command tells the shell to run the command in the <em>background</em>
 and move immediately to the next command. Not having commands run in 
the background will lead to your X session script getting stuck on the 
first command listed in the file, so that all you see is an empty 
desktop. For example, if you always want to have a terminal open when 
you first login, include a line that says: <span class="anchor" id="line-32"></span></p></li></ol><p class="line867"><span class="anchor" id="line-33"></span><span class="anchor" id="line-34"></span></p><pre>gnome-terminal &amp;</pre><span class="anchor" id="line-35"></span><ol start="5" type="1"><li><p class="line862">On the last line, type in the word <strong>exec</strong> and then the name of the window manager or desktop environment you want to use as shown in the example below: <span class="anchor" id="line-36"></span></p></li></ol><p class="line867"><span class="anchor" id="line-37"></span><span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span><span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span></p><pre># for GNOME, use this command
exec gnome-session
# for KDE, us this command instead. 
exec startkde
# Note that if you have two "exec" lines, X will only process the first, and ignore all others. Also, any line
# that begins with a # will be treated by the shell as a comment and ignored. Use this to your advantage
# by placing notes in your script or disabling commands that you do not currently wish to run.</pre><span class="anchor" id="line-45"></span><ol start="6" type="1"><li>When you are satisfied, save your file and close the text editor. <span class="anchor" id="line-46"></span></li><li>Now make your X session script executable. To do this, type the following command into your terminal: <span class="anchor" id="line-47"></span></li></ol><p class="line867"><span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span></p><pre>chmod +x ~/.xinitrc</pre><span class="anchor" id="line-50"></span><ol start="8" type="1"><li>Now
 that you have made your X session script executable, you are ready to 
try it out. To do so, save all documents you might have open, and close 
all applications. Log out of GNOME. Press CTRL+ALT+F1 to access a text 
console, and login. Once you have logged in, you have to temporarily 
disable your graphical login. To do this, enter the command <span class="anchor" id="line-51"></span></li></ol><p class="line867"><span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span></p><pre>sudo /etc/init.d/gdm stop</pre><span class="anchor" id="line-54"></span><ol start="9" type="1"><li>Once you have done this, you will be ready to test your X session script. To test it, enter the following command: <span class="anchor" id="line-55"></span></li></ol><p class="line867"><span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span></p><pre>startx</pre><span class="anchor" id="line-58"></span><ol start="10" type="1"><li>If
 you have not mispelled the names of any commands, then you should have a
 graphical desktop. If not, then you will have to correct your script. 
The shell will tell give you the line number if a command fails to make 
fixing your script easier. To fix your script, you can either edit your 
file with nano: <span class="anchor" id="line-59"></span></li></ol><p class="line867"><span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span></p><pre>nano -w</pre><span class="anchor" id="line-62"></span><ul><li style="list-style-type: none;">Or you can restart the graphical login manager with the following command, login, and perform steps 1 and 2: <span class="anchor" id="line-63"></span></li></ul><p class="line867"><span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span></p><pre>sudo /etc/init.d/gdm start</pre><span class="anchor" id="line-66"></span><ul><li style="list-style-type: none;"><p class="line862">Otherwise, log out of the graphical desktop you brought up with the <strong>startx</strong> command. <span class="anchor" id="line-67"></span></p></li><li><p class="line862">Your login script, <strong>.xinitrc</strong>, works with <strong>startx</strong>, but graphical login managers like GDM do not look for <strong>.xinitrc</strong>. Instead, they look for a file named <strong>.xsession</strong> in your home directory. To make GDM run your .xinitrc script, you have to link it to .xsession with the following command: <span class="anchor" id="line-68"></span></p></li></ul><p class="line867"><span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span></p><pre>ln -s ~/.xinitrc ~/.xsession</pre><span class="anchor" id="line-71"></span><ul><li style="list-style-type: none;"><p class="line862">Using the above command creates a symbolic link named <strong>.xsession</strong> that points to <strong>.xinitrc</strong>. If you are familiar with Windows, it may help to think of a symbolic link (or symlink), as a kind of non-graphical shortcut. <span class="anchor" id="line-72"></span></p></li><li><p class="line862">Once you have linked <strong>.xsession</strong> to <strong>.xinitrc</strong>,
 you are ready to make your graphical login manager run your custom 
environment instead of a default session. To do, begin by restarting the
 graphical login manager: <span class="anchor" id="line-73"></span></p></li></ul><p class="line867"><span class="anchor" id="line-74"></span><span class="anchor" id="line-75"></span></p><pre>sudo /etc/init.d/gdm start</pre><span class="anchor" id="line-76"></span><ol start="13" type="1"><li><p class="line862">Enter your user name, and then click on the <strong>Sessions</strong> button. The appearance of the <strong>Sessions</strong> button depends on whether you are using a themed greeter or not, and which greeter theme you are using. <span class="anchor" id="line-77"></span></p></li><li><p class="line862">From the <strong>Sessions</strong> menu, select <strong>Default System Session</strong>. This will make GDM run your X session script instead of one of the predefined sessions. <span class="anchor" id="line-78"></span></p></li><li>Enter your password. <span class="anchor" id="line-79"></span></li><li>Once
 you have entered your password, GDM will notify you that you have 
chosen a session different from the default and ask you if you want to 
use the session you've chosen once, or make it the default. If you make 
your custom session the default, you can select a different session at 
your next login. <span class="anchor" id="line-80"></span><span class="anchor" id="line-81"></span></li></ol><p class="line867">
</p><h2 id="Sample ~/.xinitrc File">Sample ~/.xinitrc File</h2>
<span class="anchor" id="line-82"></span><span class="anchor" id="line-83"></span><p class="line862">The following is the <strong>.xinitrc</strong>
 file that the author of this HOWTO, Stormy Eyes, uses at home. It makes
 use of apps not part of the default install, like xcompmgr for 
compositing effects and feh for setting wallpapers. If you have any 
questions about the example .xinitrc file, please ask them in the forum.
 <span class="anchor" id="line-84"></span><span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span><span class="anchor" id="line-87"></span><span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span><span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span><span class="anchor" id="line-93"></span><span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span><span class="anchor" id="line-96"></span><span class="anchor" id="line-97"></span><span class="anchor" id="line-98"></span><span class="anchor" id="line-99"></span><span class="anchor" id="line-100"></span><span class="anchor" id="line-101"></span><span class="anchor" id="line-102"></span><span class="anchor" id="line-103"></span><span class="anchor" id="line-104"></span></p><pre> #!/usr/bin/env bash

xcompmgr -fF -I-.002 -O-.003 -D1 &amp;
devilspie &amp;
sudo killall -9 esd
sh ./.fehbg &amp;
xrdb -merge .Xdefaults &amp;

export OOO_FORCE_DESKTOP=gnome
export LANG="en_US.UTF-8"
export LC_ALL="en_US.UTF-8"
export LANGUAGE="en_US.UTF-8"
export LC_CTYPE="en_US.UTF-8"

gnome-settings-daemon &amp;
gnome-volume-manager &amp;
conky &amp;

exec openbox</pre><span class="anchor" id="line-105"></span><span class="anchor" id="line-106"></span><p class="line867">
</p><h2 id="Questions and Comments">Questions and Comments</h2>
<span class="anchor" id="line-107"></span><span class="anchor" id="line-108"></span><p class="line862">If you have any questions or comments pertaining to this tutorial, please post them <a class="http" href="http://ubuntuforums.org/showthread.php?p=427953">on the Ubuntu Forum</a>. Thank you. <span class="anchor" id="line-109"></span></p><hr><p class="line874"> <span class="anchor" id="line-110"></span><a href="https://wiki.ubuntu.com/CategoryDocumentation">CategoryDocumentation</a> <a href="https://wiki.ubuntu.com/CategoryCleanup">CategoryCleanup</a> <span class="anchor" id="line-111"></span><span class="anchor" id="bottom"></span></p></div><p id="pageinfo" class="info" dir="ltr" lang="en">CustomXSession  (last edited 2009-11-21 09:27:40 by <span title="https://login.launchpad.net/+id/FnEeMXz @ 5ee5397b.ftth.concepts.nl[94.229.57.123]"><a class="interwiki" href="https://launchpad.net/%7Elaunchpad-bzzt" title="https://login.launchpad.net/+id/FnEeMXz @ 5ee5397b.ftth.concepts.nl[94.229.57.123]">raboof</a></span>)</p>

<div id="pagebottom"></div>
</div>


<div id="footer">

  <div id="ubuntulinks">
     © 2008 <a href="http://www.canonical.com/">Canonical Ltd</a>. Ubuntu, Kubuntu, Edubuntu, Xubuntu and Canonical are registered trademarks of Canonical Ltd.<br>
     <a href="http://www.ubuntu.com/feedback">Feedback</a> — 
     <a href="http://www.ubuntu.com/legal">Legal</a> — 
     <a href="https://wiki.ubuntu.com/wiki/credits">Credits</a> — 
     <a href="http://www.ubuntu.com/sitemap">Site Map</a> —
     <a href="http://moinmoin.wikiwikiweb.de/">Powered By the MoinMoin Wiki Engine</a>
  </div>
<script src="CustomXSession_files/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-1018242-7";
urchinTracker();
__utmSetVar('UbuntuWiki');
</script>


</div>
</body></html>